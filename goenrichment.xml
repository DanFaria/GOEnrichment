<tool id="goenrichment" name="GOEnrichment" version="1.2.1">
	<description>performs GO enrichment analysis of a set of gene products</description>
	<command interpreter="java -jar">GOEnrichment.jar 
--go $go
--annotation $annotation
--study $study
#if str($population) != 'None'
--population $population
#end if
--correction $correction
#if str($singletons) == 'true'
--ignore_singletons
#end if
#if str($relations) == 'true'
--use_all_relations
#end if
--cut_off $cutoff
--mf_result $mf_result
--bp_result $bp_result
--cc_result $cc_result
--mf_graph $mf_graph
--bp_graph $bp_graph
--cc_graph $cc_graph
</command>
    <stdio>
        <exit_code range="1:"  level="fatal"   description="Fatal ERROR exit code greater than 1" />
    </stdio>
	<inputs>
		<param name="go" type="data" format="obo,owl" label="Gene Ontology File" help="Gene Ontology file in OBO or OWL format (see http://geneontology.org/page/download-ontology)"/>
		<param name="annotation" type="data" label="Gene Product Annotation File" help="Tabular file containing annotations from gene products to GO terms (in GAF or BLAST2GO format, or a simple two-column table)"/>
		<param name="study" type="data" label="Study Set File" help="File containing the gene products corresponding to the study set (one per line)"/>
		<param name="population" type="data" optional="true" label="Population Set File (Optional)" help="File containing the gene products corresponding to the population set (one per line). If no file is submitted, the population set will be the set of all gene products listed in the annotation file."/>
		<param name="correction" type="select" label="Multiple Test Correction" help="The multiple test correction method to use. We recommend Benjamini-Hochberg in settings where a multiple test correction was already employed in selecting the set of gene products, and SDA or Bonferroni-Holm otherwise.">
			<option value="Benjamini-Hochberg" selected="true"/>
			<option value="SDA"/>
			<option value="Bonferroni-Holm"/>
			<option value="Sidak"/>
			<option value="Bonferroni"/>
		</param>
		<param name="singletons" type="boolean" checked="true" label="Exclude Singletons" help="Whether to exclude GO terms that are annotated to a single gene product in the study set"/>
		<param name="relations" type="boolean" checked="false" label="Use All Relations" help="Whether to infer annotations through 'part_of' and other non-hierarchical relationships, or only through 'is_a' relations"/>
		<param name="cutoff" type="select" label="P-Value Cut-Off" help="The corrected p-value (or q-value) cut-off to apply for the graph output.">
			<option value="1.0"/>
			<option value="0.1"/>
			<option value="0.05" selected="true"/>
			<option value="0.01"/>
		</param>
	</inputs>
	<outputs>
		<data name="mf_result" format="tabular" label="MF Result File" help="Result file listing molecular function terms"/>
		<data name="bp_result" format="tabular" label="BP Result File" help="Result file listing biological process terms"/>
		<data name="cc_result" format="tabular" label="CC Result File" help="Result file listing cellular component terms"/>
		<data name="mf_graph" format="GenericXml" label="MF Graph File" help="Graph file showing molecular function terms"/>
		<data name="bp_graph" format="GenericXml" label="BP Graph File" help="Graph file showing biological process terms"/>
		<data name="cc_graph" format="GenericXml" label="CC Graph File" help="Graph file showing cellular component terms"/>
	</outputs>
	<help>
.. class:: infomark

GOEnrichment is a Java application that can be used to analyze gene product sets (e.g., from microarray experiments) for enriched GO terms.

-----

.. class:: infomark

GOEnrichment requires:

- -A Gene Ontology file in either OBO or OWL format (see http://geneontology.org/page/download-ontology).
- -A tabular annotation file in GAF (http://geneontology.org/page/download-annotations) format, BLAST2GO format, or a simple two-column table (e.g. from BioMart) with gene product ids in the first column and GO terms in the second one. This file can be GZipped.
- -A list of gene products comprising the study set (a flat text file with one gene product per line).
- -Optionally, a list of gene products comprising the population set (if none is submitted, the population set will be the set of gene products listed in the annotation file).

-----

.. class:: infomark

GOEnrichment produces a result file and a graph file for each GO type (MF, BP and CC):

- -The result file is a tabular list of all GO terms present in the study set and their respective p-values.
- -The graph file is a GraphML file that can be viewed in the yEd free Graph editor (http://www.yworks.com/en/products/yfiles/yed/).

-----

.. class:: infomark

Note that the graph file is unformatted (all nodes will appear superposed when you initially open it).
You can format the graph in yEd in two simple steps:

- -Tools > Fit Node to Label [Make sure that neither 'Ignore Width' nor 'Ignore Height' are checked]
- -Layout > Hierarchical [Set 'Orientation' to 'Bottom to Top']


The graph is colored by p-value: terms with p-value above cut-off appear in white; and the color gets darker as the p-value decreases.
In addition to the name of each GO term, it shows its frequency in the study set.
Dashed edges indicate that one or more redundant intermediate terms (see below) were excluded from the graph path.

-----

.. class:: warningmark

Gene products listed in either the study or population set files that are not present in the annotation file will be ignored.
GO terms that are redundant (i.e., have the exact same set of annotations as any one of their children) will be automatically excluded from the analysis and outputs.
	</help>
</tool>